<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>My German Trainer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { margin:0; font-family:system-ui; background:#0d1117; color:#c9d1d9; padding:20px; line-height:1.8; }
    h1 { text-align:center; color:#58a6ff; font-size:3em; margin:40px 0 20px; }
    .streak { font-size:80px; text-align:center; margin:50px 0; }
    .status { text-align:center; padding:15px; font-size:1.3em; }
    .card { 
      background:#161b22; padding:40px; border-radius:20px; margin:40px 0; 
      box-shadow:0 12px 50px rgba(0,0,0,0.7); text-align:center; font-size:1.5em;
    }
    .german { font-size:3.5em; font-weight:bold; margin:20px 0; color:#fff; }
    .article { font-size:1.8em; opacity:0.8; margin-bottom:10px; }
    .english { font-size:2.2em; margin:30px 0; color:#79c0ff; }
    .example { margin:25px 0; font-style:italic; opacity:0.9; }
    .translation { margin-top:15px; opacity:0.8; font-size:0.9em; }
    button { background:#238636; color:white; border:none; padding:20px; border-radius:12px; 
             font-size:28px; width:100%; margin:40px 0; cursor:pointer; }
  </style>
</head>
<body>

<h1>My German Trainer</h1>
<div class="streak">ðŸ”¥ <span id="streak">0</span></div>
<div class="status" id="status">Loading your words...</div>

<div id="currentCard"></div>

<button onclick="nextCard()">Next Card â†’</button>

<script>
// CHANGE ONLY THIS LINE
const CSV_FILE = "germannonum.csv";   // â† your CSV filename

let deck = [];

fetch(CSV_FILE)
  .then(r => r.ok ? r.text() : Promise.reject())
  .then(text => {
    const lines = text.trim().split('\n');
    for (let i = 1; i < lines.length; i++) {
      const c = lines[i].split(',').map(x => x.trim().replace(/^"|"$/g,''));
      if (c.length < 5 || !c[0]) continue;

      deck.push({
        german: c[0],
        english: c[1],
        article: c[2],
        ex_de: c[3],
        ex_en: c[4],
        next: 0,
        interval: 1
      });
    }

    document.getElementById('status').textContent = `${deck.length} words ready!`;
    loadStreak();
    nextCard();
  })
  .catch(() => document.getElementById('status').innerHTML = `<span style="color:#ff5555">"${CSV_FILE}" not found!</span>`);

function nextCard() {
  const due = deck.filter(c => new Date(c.next) <= new Date());
  if (due.length === 0) {
    document.getElementById('currentCard').innerHTML = '<div class="card"><p style="font-size:3em;">All done for today! ðŸŽ‰</p></div>';
    return;
  }

  const card = due[Math.floor(Math.random() * due.length)];

  document.getElementById('currentCard').innerHTML = `
    <div class="card">
      ${card.article ? `<div class="article">${card.article}</div>` : ''}
      <div class="german">${card.german}</div>
      <div class="english">${card.english}</div>
      ${card.ex_de ? `<div class="example">${card.ex_de}</div>` : ''}
      ${card.ex_en ? `<div class="translation">${card.ex_en}</div>` : ''}
    </div>
  `;

  // Spaced repetition (still works in background)
  card.interval = Math.max(1, card.interval + Math.round(Math.random() * 3) + 1);
  card.next = Date.now() + card.interval * 24*60*60*1000;
}

function loadStreak() {
  const today = new Date().toISOString().slice(0,10);
  let s = JSON.parse(localStorage.getItem('gStreak') || '{"n":0,"d":""}');
  if (s.d !== today) {
    const yesterday = new Date(Date.now()-86400000).toISOString().slice(0,10);
    s.n = (s.d === yesterday) ? s.n + 1 : 1;
    s.d = today;
    localStorage.setItem('gStreak', JSON.stringify(s));
  }
  document.getElementById('streak').innerText = s.n;
}
</script>
</body>
</html>